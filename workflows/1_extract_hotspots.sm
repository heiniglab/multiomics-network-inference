configfile: "config.json"

include: "common.sm"

# ------------------------------------------------------------------------------
# Target rule
# ------------------------------------------------------------------------------
rule all:
	input:
		DHOTSPOTS + "eqtlgen_thres" + config["hots_thres"] + "/summary.pdf",
		DHOTSPOTS + "meqtl_thres" + config["hots_thres"] + "/summary.pdf"

# ------------------------------------------------------------------------------
# Extract eQTLgen hotspots
# ------------------------------------------------------------------------------
rule extract_eqtlgen_hotspots:
	input:
		eqtl="data/current/eqtl_gen/trans-eQTL_significant_20181017.txt.gz"
	output:
		plot=DHOTSPOTS + "eqtlgen_thres{hots_thres}/summary.pdf",
		loci_dir=directory(DHOTSPOTS + "eqtlgen_thres{hots_thres}/loci/")
	script:
		"../scripts/extract_eqtlgen_hotspots.R"

# ------------------------------------------------------------------------------
# Extract meQTL hotspots
# ------------------------------------------------------------------------------
rule extract_meqtl_hotspots:
	input:
		meqtl="data/current/meQTLs/transpairs_r02_110117_converted_1MB.txt"
	output:
		plot=DHOTSPOTS + "meqtl_thres{hots_thres}/summary.pdf",
		loci_dir=directory(DHOTSPOTS + "meqtl_thres{hots_thres}/loci/")
	script:
		"../scripts/extract_meqtl_hotspots.R"
